!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";function createEmbedIframe(src,type){var iframe=document.createElement("iframe"),_src$split=src.split("?"),_src$split2=_slicedToArray(_src$split,2),base=_src$split2[0],queryString=_src$split2[1],queryParams=toQueryParams(queryString);return queryParams.publitas_embed=type,src=base.replace(/https:\/\//,"//")+"?"+toQueryString(queryParams),iframe.setAttribute("src",src),iframe.setAttribute("width","100%"),iframe.setAttribute("height","100%"),iframe.setAttribute("frameborder",0),iframe.setAttribute("allowfullscreen",!0),iframe.style.display="block",iframe.style.boxSizing="border-box",iframe}function toQueryParams(queryString){var params={};return(queryString||"").split("&").map(function(tuple){var _tuple$split=tuple.split("="),_tuple$split2=_slicedToArray(_tuple$split,2),key=_tuple$split2[0],val=_tuple$split2[1];val&&(params[key]=val)}),params}function toQueryString(queryParams){var queryString="";return Object.keys(queryParams).map(function(key){queryString+="&"+key+"="+queryParams[key]}),queryString.slice(1)}Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{!_n&&_i.return&&_i.return()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr))return arr;if(Symbol.iterator in Object(arr))return sliceIterator(arr,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();exports.default=createEmbedIframe,module.exports=exports.default},{}],2:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function createEmbedMessageListener(iframe){var api={},callbacks={};return window.addEventListener("message",function(ev){ev.source===iframe.contentWindow&&!function(){var message=_parseReaderMessage2.default(ev.data);(callbacks[message.type]||[]).map(function(callback){return callback(message.args)})}()}),api.on=function(type,callback){callbacks[type]=callbacks[type]||[],callbacks[type].push(callback)},api.off=function(type,callback){callbacks[type]&&callbacks[type].splice(callbacks[type].indexOf(callback),1)},api}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=createEmbedMessageListener;var _parseReaderMessage=require("./parseReaderMessage"),_parseReaderMessage2=_interopRequireDefault(_parseReaderMessage);module.exports=exports.default},{"./parseReaderMessage":7}],3:[function(require,module){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_createSendEmbedMessage=require("./createSendEmbedMessage"),_createSendEmbedMessage2=_interopRequireDefault(_createSendEmbedMessage),_createEmbedMessageApi=require("./createEmbedMessageApi"),_createEmbedMessageApi2=_interopRequireDefault(_createEmbedMessageApi),_createEmbedIframe=require("./createEmbedIframe"),_createEmbedIframe2=_interopRequireDefault(_createEmbedIframe),padding=30;module.exports=function(iframe,onClose){function init(){return wrapper.appendChild(clone),wrapper.appendChild(closeButton),overlay.appendChild(wrapper),messageApi.on("stateChange",handleStateChange),overlay.addEventListener("click",handleBackdropClick),overlay}function destroy(){clone.parentNode.removeChild(clone),overlay.removeEventListener("click",handleBackdropClick),messageApi.off("stateChange",handleStateChange),onClose()}function handleStateChange(params){var state=_extends({},params.state);state.productId=null,sendMessageToOrigin("setState",{state:state})}function handleBackdropClick(){destroy()}function cloneEmbed(iframe){var src=iframe.__url?iframe.__url:iframe.src;return _createEmbedIframe2.default(src,"maximized")}function createOverlay(){var overlay=document.createElement("div");return overlay.style.position="fixed",overlay.style.top=0,overlay.style.left=0,overlay.style.bottom=0,overlay.style.right=0,overlay.style.background="rgba(0, 0, 0, .4)",overlay.style.zIndex=999999,overlay}function createWrapper(){var wrapper=document.createElement("div");return wrapper.style.position="absolute",wrapper.style.margin="0 auto",wrapper.style.border=0,wrapper.style.top=padding+"px",wrapper.style.left=padding+"px",wrapper.style.right=padding+"px",wrapper.style.maxWidth="90vh",wrapper.style.bottom=padding+"px",wrapper.style.background="#fff",wrapper}function createCloseButton(){var close=document.createElement("div");return close.style.width="30px",close.style.height="30px",close.style.position="absolute",close.style.background="#fff",close.style.textAlign="center",close.style.cursor="pointer",close.style.right=5+"px",close.style.top=5+"px",close.setAttribute("id","close-embed"),close.style.backgroundImage="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJDYXBhXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB3aWR0aD0iNjEycHgiIGhlaWdodD0iNjEycHgiIHZpZXdCb3g9IjAgMCA2MTIgNjEyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA2MTIgNjEyOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PGc+PGcgaWQ9ImNyb3NzIj48Zz48cG9seWdvbiBwb2ludHM9IjYxMiwzNi4wMDQgNTc2LjUyMSwwLjYwMyAzMDYsMjcwLjYwOCAzNS40NzgsMC42MDMgMCwzNi4wMDQgMjcwLjUyMiwzMDYuMDExIDAsNTc1Ljk5NyAzNS40NzgsNjExLjM5NyAzMDYsMzQxLjQxMSA1NzYuNTIxLDYxMS4zOTcgNjEyLDU3NS45OTcgMzQxLjQ1OSwzMDYuMDExICIvPjwvZz48L2c+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjxnPjwvZz48Zz48L2c+PGc+PC9nPjwvc3ZnPg==)",close.style.backgroundSize="20px 20px",close.style.backgroundPosition="50% 50%",close.style.backgroundRepeat="no-repeat",close}var clone=cloneEmbed(iframe),overlay=createOverlay(),wrapper=createWrapper(),closeButton=createCloseButton(),sendMessageToOrigin=(_createSendEmbedMessage2.default(clone),_createSendEmbedMessage2.default(iframe)),messageApi=_createEmbedMessageApi2.default(clone);return init()}},{"./createEmbedIframe":1,"./createEmbedMessageApi":2,"./createSendEmbedMessage":4}],4:[function(require,module,exports){"use strict";function buildMessage(type,params){return JSON.stringify([type,params])}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(iframe){return function(type,params){iframe.contentWindow.postMessage(buildMessage(type,params),"*")}},module.exports=exports.default},{}],5:[function(require,module){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function enlarge(iframe){var popup=_createEmbedPopup2.default(iframe,function(){popup.parentNode.removeChild(popup),document.body.style.overflow="auto",document.body.parentNode.style.overflow="auto"});document.body.style.overflow="hidden",document.body.parentNode.style.overflow="hidden",document.body.appendChild(popup),popup.getElementsByTagName("iframe")[0].focus()}function reset(){var clone=Array.prototype.slice.call(document.querySelectorAll("iframe")).pop();clone.parentNode.removeChild(clone),document.body.style.overflow="auto"}function initializeEventListeners(iframe,options){var messageApi=(_createSendEmbedMessage2.default(iframe),_createEmbedMessageApi2.default(iframe));messageApi.on("embed",function(param){switch(param){case"enlarge":enlarge(iframe,options);break;case"reset":reset()}}),messageApi.on("stateChange",function(params){iframe.__state=params.state,params.url&&!params.url.match(/product\/\d+$/)&&(iframe.__url=params.url)})}var _createEmbedPopup=require("./createEmbedPopup"),_createEmbedPopup2=_interopRequireDefault(_createEmbedPopup),_createSendEmbedMessage=require("./createSendEmbedMessage"),_createSendEmbedMessage2=_interopRequireDefault(_createSendEmbedMessage),_createEmbedMessageApi=require("./createEmbedMessageApi"),_createEmbedMessageApi2=_interopRequireDefault(_createEmbedMessageApi),_createEmbedIframe=require("./createEmbedIframe"),_createEmbedIframe2=_interopRequireDefault(_createEmbedIframe);module.exports.generateEmbed=function(options){var width=options.width,height=options.height,isResponsive=options.isResponsive,publicationURL=options.publicationURL,iframe=_createEmbedIframe2.default(publicationURL,"embedded"),container=document.createElement("div");return container.setAttribute("id","embed-container-"+options.wrapperId),container.style.position="absolute",container.style.top=0,container.style.left=0,isResponsive?(container.style.width="100%",container.style.height="100%"):(container.style.width=width+"px",container.style.height=height+"px"),container.appendChild(iframe),initializeEventListeners(iframe,options),container}},{"./createEmbedIframe":1,"./createEmbedMessageApi":2,"./createEmbedPopup":3,"./createSendEmbedMessage":4}],6:[function(require){"use strict";var core=require("./embedCore"),generateEmbed=core.generateEmbed;!function(scope,doc){function getOptions(script){return{wrapperId:script.getAttribute("data-wrapperId"),publicationURL:script.getAttribute("data-publication"),width:JSON.parse(script.getAttribute("data-width"))||600,height:JSON.parse(script.getAttribute("data-height"))||400,isResponsive:JSON.parse(script.getAttribute("data-responsive"))||!1,hasMenu:JSON.parse(script.getAttribute("data-menu"))||!1}}function eachReverse(ary,func){if(ary)for(var i=ary.length-1;i>-1&&(!ary[i]||!func(ary[i],i,ary));i-=1);}function scripts(){return doc.getElementsByTagName("script")}function initializeEmbedScript(script){function resizeResponsiveEmbed(){wrapper.style.maxHeight=window.innerHeight-100+"px"}var options=getOptions(script),wrapperId=options.wrapperId,publicationURL=options.publicationURL;if(!wrapperId)throw Error("wrapperId is required");if(!publicationURL)throw Error("publicationURL is required");var embed=generateEmbed(options),wrapper=doc.getElementById(wrapperId),sizer=document.createElement("div");wrapper.style.position="relative",wrapper.style.overflow="hidden",sizer.style.height=0,sizer.style.margin=0,sizer.style.paddingTop="66.7%",options.isResponsive?(wrapper.appendChild(sizer),resizeResponsiveEmbed(),window.addEventListener("resize",resizeResponsiveEmbed)):(wrapper.style.width=options.width+"px",wrapper.style.height=options.height+"px"),wrapper.appendChild(embed)}doc.addEventListener("DOMContentLoaded",function(){eachReverse(scripts(),function(script){script.hasAttribute("publitas-embed")&&(initializeEmbedScript(script),script.parentNode.removeChild(script))})})}(window,document)},{"./embedCore":5}],7:[function(require,module,exports){"use strict";function parseReaderMessage(data){var parsed=JSON.parse(data);if("[object Array]"===Object.prototype.toString.call(parsed))parsed={type:parsed[0],args:parsed[1]};else if("[object Object]"===Object.prototype.toString.call(parsed)){var key=Object.keys(parsed)[0];parsed={type:key,args:parsed[key]}}return parsed}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=parseReaderMessage,module.exports=exports.default},{}]},{},[6]);